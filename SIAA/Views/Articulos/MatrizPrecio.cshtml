@model IEnumerable<SIAAPI.Models.Comercial.MatrizPrecio>
@*@{
            ViewBag.Title = "MatrizPrecio";
            Layout = "~/Views/Shared/_Layout.cshtml";
}*@
<h4>
    <small>Establezca el rango por ejemplo de 0 a 10, el precio para ese rango y presione grabar</small>
</h4>
<hr />
<hr />
@{ 

    SIAAPI.Models.Comercial.ArticuloContext db = new SIAAPI.Models.Comercial.ArticuloContext();
    SIAAPI.Models.Comercial.Articulo articulo = db.Articulo.Find(ViewBag.id);
    if (articulo.Preciounico.Equals(false) )
    {

        using (Html.BeginForm("InsertarMatrizPrecio", "Articulos", FormMethod.Post))
        {
            <div class="form-horizontal">
                <input type="hidden" name="idmp" class="form-control" value="@ViewBag.id" />
                <div class="form-group">
                    @Html.Label("Rango Inferior", htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-8">
                        <input type="text" name="ranginfmp" id="ranginfmp" class="form-control" required="required" value="@ViewBag.rangoinferiormp" />
                    </div>
                 </div>

                <div class="form-group">
                    @Html.Label("Rango Superior", htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-8">
                        <input type="text" name="rangsupmp" id="rangsupmp" class="form-control" required="required" value="@ViewBag.rangosuperiormp" />
                    </div>
                </div>

                <div class="form-group">
                    @Html.Label("Precio", htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-8">
                        <input type="text" name="preciomp" id="preciomp" class="form-control" />
                    </div>
                </div>
            </div>
            <center><input type="submit" value="Grabar" class="btn btn-success btn-xs" /></center>
        }
    }
    if (articulo.Preciounico.Equals(true) && (ViewBag.countRangoP == null || ViewBag.countRangoP == 0))
    {
        using (Html.BeginForm("InsertarMatrizPrecio", "Articulos", FormMethod.Post))
        {
            <div class="form-horizontal">
                <input type="hidden" name="idmp" class="form-control" value="@ViewBag.id" />
                <div class="form-group">
                    @Html.Label("Rango Inferior", htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-8">
                        <input type="text" name="ranginfmp" id="ranginfmp" class="form-control" required="required" value="0.01" />
                    </div>
                </div>

                <div class="form-group">
                    @Html.Label("Rango Superior", htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-8">
                        <input type="text" name="rangsupmp" id="rangsupmp" class="form-control" required="required" value="9999999" />
                    </div>
                </div>

                <div class="form-group">
                    @Html.Label("Precio", htmlAttributes: new { @class = "control-label col-md-2" })
                    <div class="col-md-8">
                        <input type="text" name="preciomp" id="preciomp" class="form-control" />
                    </div>
                </div>
            </div>
            <center><input type="submit" value="Grabar" class="btn btn-success btn-xs" /></center>
            }

        }
    }
    <div class="table-responsive">
        <table class="table">
            <tr>
               
                @*<th>
                    @Html.DisplayNameFor(model => model.IDArticulo)
                </th>*@
                <th>
                    @Html.DisplayNameFor(model => model.RangInf)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.RangSup)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Precio)
                </th>

                <th></th>
            </tr>
            @{
               int contador = 0;
                foreach (var item in Model)
                {
                    <tr>
                      
                        @*<td>
                            @Html.DisplayFor(modelItem => item.Articulo.Descripcion)
                        </td>*@
                        <td>
                            @*@Html.DisplayFor(modelItem => item.RangInf)*@
                            @{string cadenaa = "RangoI" + contador;
                            }
                            <input type="text" class="form-control" id="@cadenaa" name="RangoI" value="@item.RangInf">
                        </td>
                        <td>
                            @*@Html.DisplayFor(modelItem => item.RangSup)*@
                            @{string cadena = "RangoS" + contador;
                            }
                            <input type="text" class="form-control" id="@cadena" name="RangoS" value="@item.RangSup">
                        </td>
                        <td>

                            @*@String.Format("{0:C}", item.Precio)*@
                            @{string cadenaaa = "Precio" + contador;
                            }
                            <input type="text" class="form-control" id="@cadenaaa" name="Precio" value="@item.Precio">
                        </td>

                        <td>

                            <a class="edit" onclick="ActualizarP(@item.idMatrizPrecio,@contador)">
                                <i class="tbl_del_btn fa fa-refresh"></i>
                            </a>

                            <a class="delete" data-id="@item.idMatrizPrecio">
                                <i class="tbl_del_btn fa fa-trash"></i>
                            </a>

                        </td>
                    </tr>
                                    contador++;
                                }
            }

        </table>
    </div>
    @*@Html.ActionLink("Regresar a la lista", "Index", null, new { @class = "btn btn-default btn-xs" })*@




    <script src="~/Scripts/libs/jquery_1.10.2/jquery-1.10.2.min.js"></script>
    <script>
        $('.delete').click(function () {
            var url = '@Url.Action("DeleteitemMatrizPrecio", "Articulos")';
            var row = $(this).closest('tr');
            $.post(url, { id: $(this).data('id') }, function (response) {
                if (response) {
                    location.reload();
                    row.remove();
                }
            }).fail(function (response) {
                // display error message?
            });
        });
    </script>

    <script>

          function ActualizarP(id, numero) {
            var urledit = '@Url.Action("EdititemMatrizPrecio", "Articulos")';
            var rangi = document.getElementById("RangoI" + numero).value
            var rangs = document.getElementById("RangoS" + numero).value
            var precio = document.getElementById("Precio" + numero).value
            alert(precio);
            $.post(urledit, { id: id, rangi: rangi, rangs: rangs, precio: precio }, function (response) {
                if (response) {
                    location.reload();
                  //  row.change;

                }
            }).fail(function (response) {
                // display error message?
            });
        }


    </script>

    @*<script>

        var urlinsert = '@Url.Action("Insertar", "MatrizPrecioCliente")';

        function Inserta(id) {
            var rangi = document.getElementById("ranginf").value
            var rangs = document.getElementById("rangsup").value
            var precio = document.getElementById("precio").value

            $.post(urlinsert, { id: id, rangi: rangi, rangs: rangs, precio: precio, IDCliente: $("#IDCliente").val(), IDArticulo: $("#IDArticulo").val() }, function (response) {
                if (response) {
                    location.reload();
                    row.change;

                }
            }).fail(function (response) {
                // display error message?
            });
        }


    </script>*@
